// This file is licensed under the MIT license
// https://github.com/sakuratan/AZlink-TinyWidget
"undefined"==typeof AZlink&&(AZlink={});
"undefined"==typeof AZlink.TinyWidget&&(AZlink.TinyWidget={},function(l){function n(a,b){var e;if(XMLHttpRequest)e=new XMLHttpRequest;else try{e=new ActiveXObject("MSXML2.XMLHTTP.6.0")}catch(f){try{e=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(c){e=new ActiveXObject("MSXML2.XMLHTTP")}}e.onreadystatechange=function(){if(4==e.readyState&&b){var a=!1;if(200==e.status)try{a=eval("("+e.responseText+")")}catch(c){}b(a,e.status)}};e.open("GET",a);e.send()}function o(a){this.url=a;this.flags=this.country=
null}function i(a,b){a.appendChild(document.createTextNode(b))}function g(a){for("string"!=typeof a&&(a=String(a));;){var b=a.replace(/^([+-]?\d+)(\d\d\d)/,"$1,$2");if(b==a)break;a=b}return a}function q(a,b,e,f){var c=b[e],d=document.createElement("a");d.href=c.link;"undefined"!=typeof f.target?f.target&&(d.target=f.target):d.target="_blank";d.className="azlink-widget-associate-link";f.onClickHook&&(d.onclick=function(){return f.onClickHook(c)});b=document.createElement("img");b.src=c.image;b.alt=
"";b.title=c.title;b.className="azlink-widget-image";d.appendChild(b);d.appendChild(document.createElement("br"));b=document.createElement("span");b.className="azlink-widget-title";if(f.order){var h=document.createElement("b");i(h,e+1+"\u4f4d");b.appendChild(h);i(b," ")}i(b,c.title);d.appendChild(b);if(!f.type||"detail"!=f.type)a.appendChild(d);else{e=[];e.push(d);if(c.info)for(d=0;d<c.info.length;++d)b=document.createElement("span"),b.className="azlink-widget-iteminfo",i(b,c.info[d]),e.push(b);c.platform&&
(b=document.createElement("span"),b.className="azlink-widget-iteminfo",i(b,c.platform),e.push(b));c.date&&(b=document.createElement("span"),d=new Date,h=c.date.split("-"),b.className=new Date(parseInt(h[0]),parseInt(h[1])-1,parseInt(h[2]))>d?"azlink-widget-date azlink-widget-new-item":"azlink-widget-date",d=c.date.replace(/-/g,"/"),i(b,d),e.push(b));d=null;c.lower_new_price&&c.upper_new_price?d=g(c.lower_new_price)+"\u5186 - "+g(c.upper_new_price)+"\u5186":c.new_price&&c.used_price?d=c.new_price<
c.used_price?g(c.new_price)+"\u5186\u304b\u3089":c.new_price!=c.used_price?g(c.used_price)+"\u5186\u304b\u3089\uff08\u65b0\u54c1"+g(c.new_price)+"\u5186\uff09":g(c.new_price)+"\u5186":c.new_price?d=g(c.new_price)+"\u5186":c.used_price?d=g(c.used_price)+"\u5186\u304b\u3089":c.list_price&&(d=g(c.list_price)+"\u5186");d&&(b=document.createElement("span"),b.className="azlink-widget-price",i(b,d),e.push(b));for(d=0;d<e.length;++d)0<d&&i(a," "),a.appendChild(e[d])}}function t(a,b){var e=document.createElement("div");
e.className="azlink-widget azlink-sidebar-widget";for(var f=0;f<a.length;++f){b._brReqd&&0<f&&e.appendChild(document.createElement("br"));var c=document.createElement("div");c.className="azlink-widget-item azlink-sidebar-widget-item";0==f&&(c.className+=" azlink-widget-first-item azlink-sidebar-widget-first-item");f==a.length-1&&(c.className+=" azlink-widget-last-item azlink-sidebar-widget-last-item");q(c,a,f,b);e.appendChild(c)}return e}function u(a,b){var e=document.createElement("table"),f=document.createElement("tbody"),
c=document.createElement("tr");e.className="azlink-widget azlink-banner-widget";e.appendChild(f);f.appendChild(c);for(f=0;f<a.length;++f){var d=document.createElement("td");d.className="azlink-widget-item azlink-banner-widget-item";0==f&&(d.className+=" azlink-widget-first-item azlink-banner-widget-first-item");f==a.length-1&&(d.className+=" azlink-widget-last-item azlink-banner-widget-last-item");q(d,a,f,b);c.appendChild(d)}return e}function p(a){if(1>a)return 0;for(;;){var b=Math.random(),b=Math.floor(b*
a);if(b!=a)return b}}function r(a){if("undefined"!=typeof j){var b="azlink-widget-embed-stub-"+v++;document.write('<span id="'+b+'" style="display:none"></span>');a.onload=function(a,f){var c=document.getElementById(b),d=f.generator(a,f),h=c.parentNode;if(d)if("string"==typeof d){var m=document.createElement("div");for(m.innerHTML=d;0<m.childNodes.length;)d=m.firstChild,m.removeChild(d),h.insertBefore(d,c)}else h.insertBefore(d,c);h.removeChild(c)};l.api(a)}}var j,s,k;document.getElementsByTagName?
k=document.getElementsByTagName("script"):document.scripts&&(k=document.scripts);k&&(s=k[k.length-1].src.replace(/[#\?].*$/,"").replace(/[^\/]*$/,""));j=s;o.prototype.toString=function(){var a="";this.country&&(a=a+("."+this.country));if(this.flags){a=a+".";a=typeof this.flags=="string"?a+this.flags:a+("_"+this.flags.join("_")+"_")}return!a?this.url:this.url.replace(/(?:\.[^\/\.]+)*(\.[^\/\.]+)$/,a+"$1")};l.api=function(a){if(typeof j!="undefined"){var b;if(a.node)b=typeof a.node=="string"?a.node:
a.node[p(a.node.length)];else{b=["bestsellers","new-releases","movers-and-shakers","most-gifted","most-wished-for"];var e=["dvd","toys","videogames","software","electronics","watch","books","musical-instruments","music"];b=b[p(b.length)]+"/"+e[p(e.length)]}if(typeof a.imageFlags=="undefined")a.imageFlags=["AA160"];e=document.getElementsByTagName("script");if((!e||!e.length)&&!document.body&&!document.documentElement)throw"Missing script or body element";var f=function(d){d=d&&d.items?d.items:[];typeof a.numItems!=
"undefined"&&d.splice(a.numItems,d.length-a.numItems);for(var b=0;b<d.length;++b){var c=d[b],e=["http://www.amazon.co.jp/exec/obidos/ASIN",c.asin];a.associateId&&e.push(a.associateId);e.push("ref=nosim/");c.link=e.join("/");c.image=typeof c.image=="undefined"?new o("http://ecx.images-amazon.com/images/G/09/nav2/dp/no-image-no-ciu.gif"):new o(c.image);if(a.imageFlags)c.image.flags=a.imageFlags}a.onload(d,a)},e=j+"json/"+b+".js",c=j+"api.php?node="+encodeURIComponent(b);n(e,function(a,b){if(b==404)n(c,
f);else{if(a&&a.expire){var e=new Date(a.expire),g=new Date,i=typeof a.probability=="undefined"?1:parseFloat(a.probability);if(e.getTime()<g.getTime()&&Math.random()<=i){n(c,f);return}}f(a,b)}})}};var v=0;l.sidebar=function(a){a=a?a:{};a.generator=t;r(a)};l.banner=function(a){a=a?a:{};a.generator=u;r(a)}}(AZlink.TinyWidget));
