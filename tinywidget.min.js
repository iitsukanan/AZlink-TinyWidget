// AZlink/TinyWidget
// This file licensed under the MIT license.
typeof AZlink=="undefined"&&(AZlink={});
if(typeof AZlink.TinyWidget=="undefined")AZlink.TinyWidget={baseuri:"",jsonUpdateProbability:1},function(h){function k(a,b){var d;if(XMLHttpRequest)d=new XMLHttpRequest;else try{d=new ActiveXObject("MSXML2.XMLHTTP.6.0")}catch(c){try{d=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){d=new ActiveXObject("MSXML2.XMLHTTP")}}d.onreadystatechange=function(){if(d.readyState==4&&b){var a=false;if(d.status==200)try{a=eval("("+d.responseText+")")}catch(c){}b(a,d.status)}};d.open("GET",a);d.send()}function l(a){this.url=
a;this.flags=this.country=null}function j(a,b){a.appendChild(document.createTextNode(b))}function g(a){for(typeof a!="string"&&(a=String(a));;){var b=a.replace(/^([+-]?\d+)(\d\d\d)/,"$1,$2");if(b==a)break;a=b}return a}function m(a,b,d){var c=document.createElement("a");c.href=b.link;c.className="azlink-widget-associate-link";if(d.onClickHook)c.onclick=function(){return d.onClickHook(b)};var e=document.createElement("img");e.src=b.image;e.alt="";e.title=b.title;e.className="azlink-widget-image";c.appendChild(e);
c.appendChild(document.createElement("br"));j(c,b.title);if(d.type&&d.type=="detail"){e=[];e.push(c);if(b.info)for(var f=0;f<b.info.length;++f)c=document.createElement("span"),c.className="azlink-widget-iteminfo",j(c,b.info[f]),e.push(c);if(b.platform)c=document.createElement("span"),c.className="azlink-widget-iteminfo",j(c,b.platform),e.push(c);if(b.date)c=document.createElement("span"),c.className="azlink-widget-date",f=b.date.replace(/-/g,"/"),j(c,f),e.push(c);f=null;b.lower_new_price&&b.upper_new_price?
f=g(b.lower_new_price)+"\u5186 - "+g(b.upper_new_price)+"\u5186":b.new_price&&b.used_price?f=b.new_price<b.used_price?g(b.new_price)+"\u5186\u304b\u3089":b.new_price!=b.used_price?g(b.used_price)+"\u5186\u304b\u3089\uff08\u65b0\u54c1"+g(b.new_price)+"\u5186\uff09":g(b.new_price)+"\u5186":b.new_price?f=g(b.new_price)+"\u5186":b.used_price?f=g(b.used_price)+"\u5186\u304b\u3089":b.list_price&&(f=g(b.list_price)+"\u5186");if(f)c=document.createElement("span"),c.className="azlink-widget-price",j(c,f),
e.push(c);for(f=0;f<e.length;++f)f>0&&j(a," "),a.appendChild(e[f])}else a.appendChild(c)}function p(a,b){var d=document.createElement("div");d.className="azlink-widget azlink-sidebar-widget";for(var c=0;c<a.length;++c){b._brReqd&&c>0&&d.appendChild(document.createElement("br"));var e=document.createElement("div");e.className="azlink-widget-item azlink-sidebar-widget-item";c==0&&(e.className+=" azlink-widget-first-item azlink-sidebar-widget-first-item");c==a.length-1&&(e.className+=" azlink-widget-last-item azlink-sidebar-widget-last-item");
m(e,a[c],b);d.appendChild(e)}return d}function q(a,b){var d=document.createElement("table");d.className="azlink-widget azlink-banner-widget";var c=document.createElement("tbody");d.appendChild(c);var e=document.createElement("tr");c.appendChild(e);for(c=0;c<a.length;++c){var f=document.createElement("td");f.className="azlink-widget-item azlink-banner-widget-item";c==0&&(f.className+=" azlink-widget-first-item azlink-banner-widget-first-item");c==a.length-1&&(f.className+=" azlink-widget-last-item azlink-banner-widget-last-item");
m(f,a[c],b);e.appendChild(f)}return d}function n(a){if(a<1)return 0;for(;;){var b=Math.random(),b=Math.floor(b*a);if(b!=a)return b}}function r(){var a=["bestsellers","new-releases","movers-and-shakers","most-gifted","most-wished-for"],b="dvd,toys,videogames,software,electronics,watch,books,musical-instruments,music".split(",");return a[n(a.length)]+"/"+b[n(b.length)]}function o(a){var b="azlink-widget-embed-stub-"+s++;document.write('<span id="'+b+'" style="display:none"></span>');a.onload=function(a,
c){var e=document.getElementById(b),f=e.parentNode,i=c.generator(a,c);if(i)if(typeof i=="string"){var g=document.createElement("div");for(g.innerHTML=i;g.childNodes.length>0;)i=g.firstChild,g.removeChild(i),f.insertBefore(i,e)}else f.insertBefore(i,e);f.removeChild(e)};h.api(a)}l.prototype.toString=function(){var a="";this.country&&(a+="."+this.country);this.flags&&(a+=".",a+=typeof this.flags=="string"?this.flags:"_"+this.flags.join("_")+"_");return!a?this.url:this.url.replace(/(?:\.[^\/\.]+)*(\.[^\/\.]+)$/,
a+"$1")};h.api=function(a){if(!a.node)a.node=r();if(typeof a.imageFlags=="undefined")a.imageFlags=["AA160"];var b=document.getElementsByTagName("script");if((!b||!b.length)&&!document.body&&!document.documentElement)throw"Missing script or body element";var d=function(b){b=b&&b.items?b.items:[];typeof a.numItems!="undefined"&&b.splice(a.numItems);for(var c=0;c<b.length;++c){var d=b[c],g=["http://www.amazon.co.jp/exec/obidos/ASIN",d.asin];a.associateId&&g.push(a.associateId);g.push("ref=nosim/");d.link=
g.join("/");d.image=typeof d.image=="undefined"?new l("http://ecx.images-amazon.com/images/G/09/nav2/dp/no-image-no-ciu.gif"):new l(d.image);if(a.imageFlags)d.image.flags=a.imageFlags}a.onload(b,a)},b=h.baseuri+"json/"+a.node+".js",c=h.baseuri+"api.php?node="+encodeURIComponent(a.node);k(b,function(a,b){if(b==404)k(c,d);else{if(a&&a.expire&&Math.random()<=0+h.jsonUpdateProbability){var g=new Date;if((new Date(a.expire)).getTime()<g.getTime()){k(c,d);return}}d(a,b)}})};var s=0;h.sidebar=function(a){a=
a?a:{};a.generator=p;o(a)};h.banner=function(a){a=a?a:{};a.generator=q;o(a)}}(AZlink.TinyWidget);
